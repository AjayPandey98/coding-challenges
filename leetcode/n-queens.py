# https://leetcode.com/problems/n-queens/

from typing import List
from timeit import default_timer as timer

from helpers import BColors


class Solution:
    def solveNQueens(self, n: int) -> List[List[str]]:
        result = []
        row = '.' * n
        for solution in self.queens(n, 0, [], [], []):
            result.append(self.arrayToString(solution, row))
        return result

    def queens(self, n, i, a, b, c):
        if i < n:
            for j in range(n):
                if j not in a and i+j not in b and i-j not in c:
                    yield from self.queens(n, i+1, a+[j], b+[i+j], c+[i-j])
        else:
            yield a

    def arrayToString(self, a: List[int], row: str) -> List[str]:
        board = []
        for index in a:
            board.append(row[:index] + 'Q' + row[index + 1:])
        return board

# Faster solution in Leetcode


class FasterSolution:
    def solveNQueens(self, n: int) -> List[List[str]]:
        board = [["."] * n for i in range(n)]
        res = []
        col = set()
        diag = set()        # r+c
        xdiag = set()       # r-c

        def solve(r):
            if r == n:
                copy = ["".join(row) for row in board]
                res.append(copy)
                return
            for c in range(n):
                if c in col or r+c in diag or r-c in xdiag:
                    continue
                col.add(c)
                diag.add(r+c)
                xdiag.add(r-c)
                board[r][c] = 'Q'
                solve(r+1)
                board[r][c] = '.'
                col.remove(c)
                diag.remove(r+c)
                xdiag.remove(r-c)

        solve(0)
        return res


solutions = {
    1: [['Q']],
    2: [],
    3: [],
    4: [
        ['.Q..', '...Q', 'Q...', '..Q.'],
        ['..Q.', 'Q...', '...Q', '.Q..'],
    ],
    5: [
        ['Q....', '..Q..', '....Q', '.Q...', '...Q.'],
        ['Q....', '...Q.', '.Q...', '....Q', '..Q..'],
        ['.Q...', '...Q.', 'Q....', '..Q..', '....Q'],
        ['.Q...', '....Q', '..Q..', 'Q....', '...Q.'],
        ['..Q..', 'Q....', '...Q.', '.Q...', '....Q'],
        ['..Q..', '....Q', '.Q...', '...Q.', 'Q....'],
        ['...Q.', 'Q....', '..Q..', '....Q', '.Q...'],
        ['...Q.', '.Q...', '....Q', '..Q..', 'Q....'],
        ['....Q', '.Q...', '...Q.', 'Q....', '..Q..'],
        ['....Q', '..Q..', 'Q....', '...Q.', '.Q...'],
    ],
    6: [
        ['.Q....', '...Q..', '.....Q', 'Q.....', '..Q...', '....Q.'],
        ['..Q...', '.....Q', '.Q....', '....Q.', 'Q.....', '...Q..'],
        ['...Q..', 'Q.....', '....Q.', '.Q....', '.....Q', '..Q...'],
        ['....Q.', '..Q...', 'Q.....', '.....Q', '...Q..', '.Q....'],
    ],
    7: [
        ['Q......', '..Q....', '....Q..', '......Q',
            '.Q.....', '...Q...', '.....Q.'],
        ['Q......', '...Q...', '......Q', '..Q....',
            '.....Q.', '.Q.....', '....Q..'],
        ['Q......', '....Q..', '.Q.....', '.....Q.',
            '..Q....', '......Q', '...Q...'],
        ['Q......', '.....Q.', '...Q...', '.Q.....',
            '......Q', '....Q..', '..Q....'],
        ['.Q.....', '...Q...', 'Q......', '......Q',
            '....Q..', '..Q....', '.....Q.'],
        ['.Q.....', '...Q...', '.....Q.', 'Q......',
            '..Q....', '....Q..', '......Q'],
        ['.Q.....', '....Q..', 'Q......', '...Q...',
            '......Q', '..Q....', '.....Q.'],
        ['.Q.....', '....Q..', '..Q....', 'Q......',
            '......Q', '...Q...', '.....Q.'],
        ['.Q.....', '....Q..', '......Q', '...Q...',
            'Q......', '..Q....', '.....Q.'],
        ['.Q.....', '.....Q.', '..Q....', '......Q',
            '...Q...', 'Q......', '....Q..'],
        ['.Q.....', '......Q', '....Q..', '..Q....',
            'Q......', '.....Q.', '...Q...'],
        ['..Q....', 'Q......', '.....Q.', '.Q.....',
            '....Q..', '......Q', '...Q...'],
        ['..Q....', 'Q......', '.....Q.', '...Q...',
            '.Q.....', '......Q', '....Q..'],
        ['..Q....', '....Q..', '......Q', '.Q.....',
            '...Q...', '.....Q.', 'Q......'],
        ['..Q....', '.....Q.', '.Q.....', '....Q..',
            'Q......', '...Q...', '......Q'],
        ['..Q....', '......Q', '.Q.....', '...Q...',
            '.....Q.', 'Q......', '....Q..'],
        ['..Q....', '......Q', '...Q...', 'Q......',
            '....Q..', '.Q.....', '.....Q.'],
        ['...Q...', 'Q......', '..Q....', '.....Q.',
            '.Q.....', '......Q', '....Q..'],
        ['...Q...', 'Q......', '....Q..', '.Q.....',
            '.....Q.', '..Q....', '......Q'],
        ['...Q...', '.Q.....', '......Q', '....Q..',
            '..Q....', 'Q......', '.....Q.'],
        ['...Q...', '.....Q.', 'Q......', '..Q....',
            '....Q..', '......Q', '.Q.....'],
        ['...Q...', '......Q', '..Q....', '.....Q.',
            '.Q.....', '....Q..', 'Q......'],
        ['...Q...', '......Q', '....Q..', '.Q.....',
            '.....Q.', 'Q......', '..Q....'],
        ['....Q..', 'Q......', '...Q...', '......Q',
            '..Q....', '.....Q.', '.Q.....'],
        ['....Q..', 'Q......', '.....Q.', '...Q...',
            '.Q.....', '......Q', '..Q....'],
        ['....Q..', '.Q.....', '.....Q.', '..Q....',
            '......Q', '...Q...', 'Q......'],
        ['....Q..', '..Q....', 'Q......', '.....Q.',
            '...Q...', '.Q.....', '......Q'],
        ['....Q..', '......Q', '.Q.....', '...Q...',
            '.....Q.', 'Q......', '..Q....'],
        ['....Q..', '......Q', '.Q.....', '.....Q.',
            '..Q....', 'Q......', '...Q...'],
        ['.....Q.', 'Q......', '..Q....', '....Q..',
            '......Q', '.Q.....', '...Q...'],
        ['.....Q.', '.Q.....', '....Q..', 'Q......',
            '...Q...', '......Q', '..Q....'],
        ['.....Q.', '..Q....', 'Q......', '...Q...',
            '......Q', '....Q..', '.Q.....'],
        ['.....Q.', '..Q....', '....Q..', '......Q',
            'Q......', '...Q...', '.Q.....'],
        ['.....Q.', '..Q....', '......Q', '...Q...',
            'Q......', '....Q..', '.Q.....'],
        ['.....Q.', '...Q...', '.Q.....', '......Q',
            '....Q..', '..Q....', 'Q......'],
        ['.....Q.', '...Q...', '......Q', 'Q......',
            '..Q....', '....Q..', '.Q.....'],
        ['......Q', '.Q.....', '...Q...', '.....Q.',
            'Q......', '..Q....', '....Q..'],
        ['......Q', '..Q....', '.....Q.', '.Q.....',
            '....Q..', 'Q......', '...Q...'],
        ['......Q', '...Q...', 'Q......', '....Q..',
            '.Q.....', '.....Q.', '..Q....'],
        ['......Q', '....Q..', '..Q....', 'Q......',
            '.....Q.', '...Q...', '.Q.....'],
    ],
    8: [
        ['Q.......', '....Q...', '.......Q', '.....Q..',
            '..Q.....', '......Q.', '.Q......', '...Q....'],
        ['Q.......', '.....Q..', '.......Q', '..Q.....',
            '......Q.', '...Q....', '.Q......', '....Q...'],
        ['Q.......', '......Q.', '...Q....', '.....Q..',
            '.......Q', '.Q......', '....Q...', '..Q.....'],
        ['Q.......', '......Q.', '....Q...', '.......Q',
            '.Q......', '...Q....', '.....Q..', '..Q.....'],
        ['.Q......', '...Q....', '.....Q..', '.......Q',
            '..Q.....', 'Q.......', '......Q.', '....Q...'],
        ['.Q......', '....Q...', '......Q.', 'Q.......',
            '..Q.....', '.......Q', '.....Q..', '...Q....'],
        ['.Q......', '....Q...', '......Q.', '...Q....',
            'Q.......', '.......Q', '.....Q..', '..Q.....'],
        ['.Q......', '.....Q..', 'Q.......', '......Q.',
            '...Q....', '.......Q', '..Q.....', '....Q...'],
        ['.Q......', '.....Q..', '.......Q', '..Q.....',
            'Q.......', '...Q....', '......Q.', '....Q...'],
        ['.Q......', '......Q.', '..Q.....', '.....Q..',
            '.......Q', '....Q...', 'Q.......', '...Q....'],
        ['.Q......', '......Q.', '....Q...', '.......Q',
            'Q.......', '...Q....', '.....Q..', '..Q.....'],
        ['.Q......', '.......Q', '.....Q..', 'Q.......',
            '..Q.....', '....Q...', '......Q.', '...Q....'],
        ['..Q.....', 'Q.......', '......Q.', '....Q...',
            '.......Q', '.Q......', '...Q....', '.....Q..'],
        ['..Q.....', '....Q...', '.Q......', '.......Q',
            'Q.......', '......Q.', '...Q....', '.....Q..'],
        ['..Q.....', '....Q...', '.Q......', '.......Q',
            '.....Q..', '...Q....', '......Q.', 'Q.......'],
        ['..Q.....', '....Q...', '......Q.', 'Q.......',
            '...Q....', '.Q......', '.......Q', '.....Q..'],
        ['..Q.....', '....Q...', '.......Q', '...Q....',
            'Q.......', '......Q.', '.Q......', '.....Q..'],
        ['..Q.....', '.....Q..', '.Q......', '....Q...',
            '.......Q', 'Q.......', '......Q.', '...Q....'],
        ['..Q.....', '.....Q..', '.Q......', '......Q.',
            'Q.......', '...Q....', '.......Q', '....Q...'],
        ['..Q.....', '.....Q..', '.Q......', '......Q.',
            '....Q...', 'Q.......', '.......Q', '...Q....'],
        ['..Q.....', '.....Q..', '...Q....', 'Q.......',
            '.......Q', '....Q...', '......Q.', '.Q......'],
        ['..Q.....', '.....Q..', '...Q....', '.Q......',
            '.......Q', '....Q...', '......Q.', 'Q.......'],
        ['..Q.....', '.....Q..', '.......Q', 'Q.......',
            '...Q....', '......Q.', '....Q...', '.Q......'],
        ['..Q.....', '.....Q..', '.......Q', 'Q.......',
            '....Q...', '......Q.', '.Q......', '...Q....'],
        ['..Q.....', '.....Q..', '.......Q', '.Q......',
            '...Q....', 'Q.......', '......Q.', '....Q...'],
        ['..Q.....', '......Q.', '.Q......', '.......Q',
            '....Q...', 'Q.......', '...Q....', '.....Q..'],
        ['..Q.....', '......Q.', '.Q......', '.......Q',
            '.....Q..', '...Q....', 'Q.......', '....Q...'],
        ['..Q.....', '.......Q', '...Q....', '......Q.',
            'Q.......', '.....Q..', '.Q......', '....Q...'],
        ['...Q....', 'Q.......', '....Q...', '.......Q',
            '.Q......', '......Q.', '..Q.....', '.....Q..'],
        ['...Q....', 'Q.......', '....Q...', '.......Q',
            '.....Q..', '..Q.....', '......Q.', '.Q......'],
        ['...Q....', '.Q......', '....Q...', '.......Q',
            '.....Q..', 'Q.......', '..Q.....', '......Q.'],
        ['...Q....', '.Q......', '......Q.', '..Q.....',
            '.....Q..', '.......Q', 'Q.......', '....Q...'],
        ['...Q....', '.Q......', '......Q.', '..Q.....',
            '.....Q..', '.......Q', '....Q...', 'Q.......'],
        ['...Q....', '.Q......', '......Q.', '....Q...',
            'Q.......', '.......Q', '.....Q..', '..Q.....'],
        ['...Q....', '.Q......', '.......Q', '....Q...',
            '......Q.', 'Q.......', '..Q.....', '.....Q..'],
        ['...Q....', '.Q......', '.......Q', '.....Q..',
            'Q.......', '..Q.....', '....Q...', '......Q.'],
        ['...Q....', '.....Q..', 'Q.......', '....Q...',
            '.Q......', '.......Q', '..Q.....', '......Q.'],
        ['...Q....', '.....Q..', '.......Q', '.Q......',
            '......Q.', 'Q.......', '..Q.....', '....Q...'],
        ['...Q....', '.....Q..', '.......Q', '..Q.....',
            'Q.......', '......Q.', '....Q...', '.Q......'],
        ['...Q....', '......Q.', 'Q.......', '.......Q',
            '....Q...', '.Q......', '.....Q..', '..Q.....'],
        ['...Q....', '......Q.', '..Q.....', '.......Q',
            '.Q......', '....Q...', 'Q.......', '.....Q..'],
        ['...Q....', '......Q.', '....Q...', '.Q......',
            '.....Q..', 'Q.......', '..Q.....', '.......Q'],
        ['...Q....', '......Q.', '....Q...', '..Q.....',
            'Q.......', '.....Q..', '.......Q', '.Q......'],
        ['...Q....', '.......Q', 'Q.......', '..Q.....',
            '.....Q..', '.Q......', '......Q.', '....Q...'],
        ['...Q....', '.......Q', 'Q.......', '....Q...',
            '......Q.', '.Q......', '.....Q..', '..Q.....'],
        ['...Q....', '.......Q', '....Q...', '..Q.....',
            'Q.......', '......Q.', '.Q......', '.....Q..'],
        ['....Q...', 'Q.......', '...Q....', '.....Q..',
            '.......Q', '.Q......', '......Q.', '..Q.....'],
        ['....Q...', 'Q.......', '.......Q', '...Q....',
            '.Q......', '......Q.', '..Q.....', '.....Q..'],
        ['....Q...', 'Q.......', '.......Q', '.....Q..',
            '..Q.....', '......Q.', '.Q......', '...Q....'],
        ['....Q...', '.Q......', '...Q....', '.....Q..',
            '.......Q', '..Q.....', 'Q.......', '......Q.'],
        ['....Q...', '.Q......', '...Q....', '......Q.',
            '..Q.....', '.......Q', '.....Q..', 'Q.......'],
        ['....Q...', '.Q......', '.....Q..', 'Q.......',
            '......Q.', '...Q....', '.......Q', '..Q.....'],
        ['....Q...', '.Q......', '.......Q', 'Q.......',
            '...Q....', '......Q.', '..Q.....', '.....Q..'],
        ['....Q...', '..Q.....', 'Q.......', '.....Q..',
            '.......Q', '.Q......', '...Q....', '......Q.'],
        ['....Q...', '..Q.....', 'Q.......', '......Q.',
            '.Q......', '.......Q', '.....Q..', '...Q....'],
        ['....Q...', '..Q.....', '.......Q', '...Q....',
            '......Q.', 'Q.......', '.....Q..', '.Q......'],
        ['....Q...', '......Q.', 'Q.......', '..Q.....',
            '.......Q', '.....Q..', '...Q....', '.Q......'],
        ['....Q...', '......Q.', 'Q.......', '...Q....',
            '.Q......', '.......Q', '.....Q..', '..Q.....'],
        ['....Q...', '......Q.', '.Q......', '...Q....',
            '.......Q', 'Q.......', '..Q.....', '.....Q..'],
        ['....Q...', '......Q.', '.Q......', '.....Q..',
            '..Q.....', 'Q.......', '...Q....', '.......Q'],
        ['....Q...', '......Q.', '.Q......', '.....Q..',
            '..Q.....', 'Q.......', '.......Q', '...Q....'],
        ['....Q...', '......Q.', '...Q....', 'Q.......',
            '..Q.....', '.......Q', '.....Q..', '.Q......'],
        ['....Q...', '.......Q', '...Q....', 'Q.......',
            '..Q.....', '.....Q..', '.Q......', '......Q.'],
        ['....Q...', '.......Q', '...Q....', 'Q.......',
            '......Q.', '.Q......', '.....Q..', '..Q.....'],
        ['.....Q..', 'Q.......', '....Q...', '.Q......',
            '.......Q', '..Q.....', '......Q.', '...Q....'],
        ['.....Q..', '.Q......', '......Q.', 'Q.......',
            '..Q.....', '....Q...', '.......Q', '...Q....'],
        ['.....Q..', '.Q......', '......Q.', 'Q.......',
            '...Q....', '.......Q', '....Q...', '..Q.....'],
        ['.....Q..', '..Q.....', 'Q.......', '......Q.',
            '....Q...', '.......Q', '.Q......', '...Q....'],
        ['.....Q..', '..Q.....', 'Q.......', '.......Q',
            '...Q....', '.Q......', '......Q.', '....Q...'],
        ['.....Q..', '..Q.....', 'Q.......', '.......Q',
            '....Q...', '.Q......', '...Q....', '......Q.'],
        ['.....Q..', '..Q.....', '....Q...', '......Q.',
            'Q.......', '...Q....', '.Q......', '.......Q'],
        ['.....Q..', '..Q.....', '....Q...', '.......Q',
            'Q.......', '...Q....', '.Q......', '......Q.'],
        ['.....Q..', '..Q.....', '......Q.', '.Q......',
            '...Q....', '.......Q', 'Q.......', '....Q...'],
        ['.....Q..', '..Q.....', '......Q.', '.Q......',
            '.......Q', '....Q...', 'Q.......', '...Q....'],
        ['.....Q..', '..Q.....', '......Q.', '...Q....',
            'Q.......', '.......Q', '.Q......', '....Q...'],
        ['.....Q..', '...Q....', 'Q.......', '....Q...',
            '.......Q', '.Q......', '......Q.', '..Q.....'],
        ['.....Q..', '...Q....', '.Q......', '.......Q',
            '....Q...', '......Q.', 'Q.......', '..Q.....'],
        ['.....Q..', '...Q....', '......Q.', 'Q.......',
            '..Q.....', '....Q...', '.Q......', '.......Q'],
        ['.....Q..', '...Q....', '......Q.', 'Q.......',
            '.......Q', '.Q......', '....Q...', '..Q.....'],
        ['.....Q..', '.......Q', '.Q......', '...Q....',
            'Q.......', '......Q.', '....Q...', '..Q.....'],
        ['......Q.', 'Q.......', '..Q.....', '.......Q',
            '.....Q..', '...Q....', '.Q......', '....Q...'],
        ['......Q.', '.Q......', '...Q....', 'Q.......',
            '.......Q', '....Q...', '..Q.....', '.....Q..'],
        ['......Q.', '.Q......', '.....Q..', '..Q.....',
            'Q.......', '...Q....', '.......Q', '....Q...'],
        ['......Q.', '..Q.....', 'Q.......', '.....Q..',
            '.......Q', '....Q...', '.Q......', '...Q....'],
        ['......Q.', '..Q.....', '.......Q', '.Q......',
            '....Q...', 'Q.......', '.....Q..', '...Q....'],
        ['......Q.', '...Q....', '.Q......', '....Q...',
            '.......Q', 'Q.......', '..Q.....', '.....Q..'],
        ['......Q.', '...Q....', '.Q......', '.......Q',
            '.....Q..', 'Q.......', '..Q.....', '....Q...'],
        ['......Q.', '....Q...', '..Q.....', 'Q.......',
            '.....Q..', '.......Q', '.Q......', '...Q....'],
        ['.......Q', '.Q......', '...Q....', 'Q.......',
            '......Q.', '....Q...', '..Q.....', '.....Q..'],
        ['.......Q', '.Q......', '....Q...', '..Q.....',
            'Q.......', '......Q.', '...Q....', '.....Q..'],
        ['.......Q', '..Q.....', 'Q.......', '.....Q..',
            '.Q......', '....Q...', '......Q.', '...Q....'],
        ['.......Q', '...Q....', 'Q.......', '..Q.....',
         '.....Q..', '.Q......', '......Q.', '....Q...'],
    ],
}


sol = Solution()
f_sol = FasterSolution()
max = 12

start = timer()
for n in range(1, max+1):
    result = sol.solveNQueens(n)
    if (n <= 8):
        assert result == solutions[n]
end = timer()
print(
    f'slow method took {end - start} seconds to calculate a solution of size {n}')


start = timer()
for n in range(1, max+1):
    result = f_sol.solveNQueens(n)
    if (n <= 8):
        assert result == solutions[n]
end = timer()
print(
    f'fast method took {end - start} seconds to calculate a solution of size {n}')

print(
    f'\n{BColors.bold}{BColors.ok_green}» All tests passed!{BColors.end_dc}\n')

# https://oeis.org/A000170/b000170.txt
# A000170 (b-file synthesized from sequence entry)
# 0 1
# 1 1
# 2 0
# 3 0
# 4 2
# 5 10
# 6 4
# 7 40
# 8 92
# 9 352
